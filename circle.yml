machine:
  services:
    - docker

dependencies:
  override:
    - docker info:
        parallel: false
    - docker build -t:
        timeout: 3600
        parallel: true
        files:
          base:nginx nginx/
          base:shadowsocks shadowsocks/
          base:ipython ipython/

test:
  override:
    - docker run -d base:nginx
    - docker run --restart=always -p 11111:8388 -p 11111:8388/udp -e "METHOD=aes-256-cfb" -e "PASSWORD=Arizona" -d base:shadowsocks
    - docker images -a --digests
    - docker history base:nginx
    - docker history base:shadowsocks
    - docker history base:ipython
    - docker ps
